import type { Metadata } from 'next'
import '@/global/styles/index.scss'
import { StoreProvider } from '@/global/providers/StoreProvider'
import { ThemeProvider } from '@/global/providers/ThemeProvider'
import { PlayerProvider } from '@/global/providers/PlayerProvider/PlayerProvider'
import { AudioProvider } from '@/global/providers/AudioProvider'
import { Navbar } from '@/widgets/Navbar'
import { SessionProvider } from '@/global/providers/SessionProvider/SessionProvider'
import { PageContainer } from '@/shared/ui/PageContainer'
import { getIsMobile } from '@/shared/lib/helpers/getIsMobile/getIsMobile'
import { AuthErrorHandler } from '@/global/providers/AuthErrorHandler'
import { Toast } from '@/feature/Toast'
import { ConfirmEmailWarningDialog } from '@/feature/ConfirmEmailWarningDialog'

export const metadata: Metadata = {
    title: 'MuCloud',
    description: 'Generated by create next app',
}

export default function RootLayout({
    children,
}: {
  children: React.ReactNode
}) {

    const isMobile = getIsMobile()

    return (
        <ThemeProvider>
            <SessionProvider>
                <AuthErrorHandler>
                    <StoreProvider>
                        <html lang="en">
                            <head>
                                <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon.png"/>
                                <link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png"/>
                                <link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png"/>
                                <link rel="manifest" href="favicons/site.webmanifest"/>
                                <link rel="mask-icon" href="favicons/safari-pinned-tab.svg" color="#1a232e"/>
                                <meta name="msapplication-TileColor" content="#1a232e"/>
                                <meta name="msapplication-TileImage" content="favicons/mstile-144x144.png"/>
                                <meta name="theme-color" content="#1a232e"/>
                            </head>
                            <body className='app__default_theme'>
                                <PageContainer isMobile={isMobile}>
                                    {children}
                                </PageContainer>
                                <Navbar isMobile={isMobile}/>
                                <AudioProvider>
                                    <PlayerProvider isMobile={isMobile}/>
                                </AudioProvider>
                                <Toast isMobile={isMobile}/>
                                <ConfirmEmailWarningDialog/>
                            </body>
                        </html>
                    </StoreProvider>
                </AuthErrorHandler>
            </SessionProvider>
        </ThemeProvider>
    )
}
