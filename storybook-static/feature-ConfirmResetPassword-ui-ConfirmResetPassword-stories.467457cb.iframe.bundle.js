"use strict";(self.webpackChunkmu_cloud=self.webpackChunkmu_cloud||[]).push([[8089],{"./src/feature/ConfirmResetPassword/ui/ConfirmResetPassword.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Idle:()=>Idle,default:()=>ConfirmResetPassword_stories});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),StoreDecorator=__webpack_require__("./src/shared/config/storybook/StoreDecorator/StoreDecorator.tsx"),backendUrl=__webpack_require__("./src/shared/const/backendUrl.ts"),react=__webpack_require__("./node_modules/react/index.js"),DynamicModuleLoader=__webpack_require__("./src/shared/config/DynamicModuleLoader/DynamicModuleLoader.tsx"),Form=__webpack_require__("./src/shared/ui/Form/index.ts"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),store=__webpack_require__("./src/global/providers/StoreProvider/config/store.ts"),Input=__webpack_require__("./src/shared/ui/Input/index.ts"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),redux_toolkit_esm=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),config={password:{messages:{empty:"Пароль не должен быть пустым",exceedsMaxLenght:"Длина пароля должна быть не более 50 символов",exceedsMinLenght:"Длина пароля должна быть не менее 8 символов",hasBannedSymbols:"Пароль не должен содержать пробелы"},maxLenght:50,minLenght:8,bannedSymbols:[" "]},passwordConfirm:{messages:{empty:"Пароль не подтвержден",notEqualsToPassword:"Пароли не совпадают"}}},dist=__webpack_require__("./node_modules/react-hot-toast/dist/index.mjs"),getPassword=function getPassword(state){var _state$confirmResetPa;return null==state||null===(_state$confirmResetPa=state.confirmResetPassword)||void 0===_state$confirmResetPa?void 0:_state$confirmResetPa.password},getPasswordConfirm=function getPasswordConfirm(state){var _state$confirmResetPa2;return null==state||null===(_state$confirmResetPa2=state.confirmResetPassword)||void 0===_state$confirmResetPa2?void 0:_state$confirmResetPa2.passwordConfirm},getFieldValidationErrorMessage=__webpack_require__("./src/shared/lib/helpers/getFieldValidationErrorMessage/getFieldValidationErrorMessage.ts"),getValidationError=function getValidationError(state){var _state$confirmResetPa,validationErrors=null==state||null===(_state$confirmResetPa=state.confirmResetPassword)||void 0===_state$confirmResetPa?void 0:_state$confirmResetPa.validationErrors;return(0,getFieldValidationErrorMessage.A)(validationErrors,config)},confirm_confirm=(0,redux_toolkit_esm.hg)("confirmResetPassword/confirm",function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(_,thunkApi){var dispatch,rejectWithValue,getState,password,passwordConfirm,body,response;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(dispatch=thunkApi.dispatch,rejectWithValue=thunkApi.rejectWithValue,getState=thunkApi.getState,password=getPassword(getState()),passwordConfirm=getPasswordConfirm(getState()),dispatch(confirmResetPasswordActions.validatePassword(password)),dispatch(confirmResetPasswordActions.validatePasswordConfirm(passwordConfirm)),!getValidationError(getState())){_context.next=8;break}return _context.abrupt("return");case 8:if(body={newPassword:password,token:new URLSearchParams(location.search).get("token")},_context.prev=9,window.navigator.onLine){_context.next=12;break}return _context.abrupt("return",(0,dist.ZP)("Ошибка. Нет соединения с интернетом"));case 12:return _context.next=14,fetch(backendUrl.A+"/auth/reset",{method:"POST",body:JSON.stringify(body),headers:{"Content-Type":"application/json"}});case 14:if(500!==(response=_context.sent).status){_context.next=17;break}return _context.abrupt("return",rejectWithValue("Сервер недоступен"));case 17:if(400!==response.status){_context.next=19;break}return _context.abrupt("return",rejectWithValue("Ссылка устарела"));case 19:if(201!==response.status){_context.next=22;break}return(0,dist.ZP)("Сохранено"),_context.abrupt("return");case 22:throw Error();case 25:return _context.prev=25,_context.t0=_context.catch(9),_context.abrupt("return",rejectWithValue("Произошла неожиданная ошибка"));case 28:case"end":return _context.stop()}}),_callee,null,[[9,25]])})));return function(_x,_x2){return _ref.apply(this,arguments)}}()),ConfirmResetPasswordSlice=(0,redux_toolkit_esm.oM)({name:"confirmResetPassword",initialState:{password:"",passwordConfirm:"",status:"idle",validationErrors:{password:{empty:!1,exceedsMaxLenght:!1,exceedsMinLenght:!1,hasBannedSymbols:!1},passwordConfirm:{empty:!1,notEqualsToPassword:!1}}},reducers:{setPassword:function setPassword(state,action){state.password=action.payload},setPasswordConfirm:function setPasswordConfirm(state,action){state.passwordConfirm=action.payload},validatePassword:function validatePassword(state,action){var password=action.payload;if(!password)return state.validationErrors.password.empty=!0,state.validationErrors.password.exceedsMaxLenght=!1,void(state.validationErrors.password.exceedsMinLenght=!1);state.validationErrors.password.empty=!1,password.length>config.password.maxLenght?state.validationErrors.password.exceedsMaxLenght=!0:password.length<config.password.minLenght?state.validationErrors.password.exceedsMinLenght=!0:(state.validationErrors.password.exceedsMaxLenght=!1,state.validationErrors.password.exceedsMinLenght=!1),state.validationErrors.password.hasBannedSymbols=config.password.bannedSymbols.some((function(symbol){return state.password.includes(symbol)}))},validatePasswordConfirm:function validatePasswordConfirm(state,action){var passwordConfirm=action.payload;passwordConfirm?(state.validationErrors.passwordConfirm.empty=!1,passwordConfirm!==state.password?state.validationErrors.passwordConfirm.notEqualsToPassword=!0:state.validationErrors.passwordConfirm.notEqualsToPassword=!1):state.validationErrors.passwordConfirm.empty=!0}},extraReducers:function extraReducers(builder){builder.addCase(confirm_confirm.pending,(function(state){state.status="loading",state.requestError=void 0})).addCase(confirm_confirm.fulfilled,(function(state){state.status="success",state.requestError=void 0})).addCase(confirm_confirm.rejected,(function(state,action){state.status="error",state.requestError=action.payload}))}}),confirmResetPasswordActions=ConfirmResetPasswordSlice.actions,confirmResetPasswordReducer=ConfirmResetPasswordSlice.reducer,setPassword=(0,redux_toolkit_esm.hg)("confirmResetPassword/setPassword",function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(password,thunkApi){var dispatch;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:(dispatch=thunkApi.dispatch)(confirmResetPasswordActions.validatePassword(password)),dispatch(confirmResetPasswordActions.setPassword(password));case 3:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref.apply(this,arguments)}}()),checkError=__webpack_require__("./src/shared/lib/helpers/checkError/checkError.ts"),getIsPasswordValidationError=function getIsPasswordValidationError(state){var _state$confirmResetPa,errors=null==state||null===(_state$confirmResetPa=state.confirmResetPassword)||void 0===_state$confirmResetPa?void 0:_state$confirmResetPa.validationErrors.password;return(0,checkError.r)(errors)},getStatus=function getStatus(state){var _state$confirmResetPa;return null==state||null===(_state$confirmResetPa=state.confirmResetPassword)||void 0===_state$confirmResetPa?void 0:_state$confirmResetPa.status},__jsx=react.createElement,PasswordInput=function PasswordInput(props){var password=(0,es.v9)(getPassword),dispatch=(0,store.T)(),isError=(0,es.v9)(getIsPasswordValidationError),status=(0,es.v9)(getStatus),onChangePassword=(0,react.useCallback)((function(e){dispatch(setPassword(e.target.value))}),[dispatch]);return __jsx(Input.I,{label:"Пароль",value:password,type:"password",onChange:onChangePassword,isError,disabled:"loading"===status})};PasswordInput.displayName="PasswordInput",PasswordInput.__docgenInfo={description:"",methods:[],displayName:"PasswordInput"};try{PasswordInput.displayName="PasswordInput",PasswordInput.__docgenInfo={description:"",displayName:"PasswordInput",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/feature/ConfirmResetPassword/ui/PasswordInput/PasswordInput.tsx#PasswordInput"]={docgenInfo:PasswordInput.__docgenInfo,name:"PasswordInput",path:"src/feature/ConfirmResetPassword/ui/PasswordInput/PasswordInput.tsx#PasswordInput"})}catch(__react_docgen_typescript_loader_error){}var setPasswordConfirm=(0,redux_toolkit_esm.hg)("confirmResetPassword/setPasswordConfirm",function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(password,thunkApi){var dispatch;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:(dispatch=thunkApi.dispatch)(confirmResetPasswordActions.validatePasswordConfirm(password)),dispatch(confirmResetPasswordActions.setPasswordConfirm(password));case 3:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref.apply(this,arguments)}}()),getIsPasswordConfirmValidationError=function getIsPasswordConfirmValidationError(state){var _state$confirmResetPa,errors=null==state||null===(_state$confirmResetPa=state.confirmResetPassword)||void 0===_state$confirmResetPa?void 0:_state$confirmResetPa.validationErrors.passwordConfirm;return(0,checkError.r)(errors)},PasswordConfirmInput_jsx=react.createElement,PasswordConfirmInput=function PasswordConfirmInput(_ref){var className=_ref.className,passwordConfirm=(0,es.v9)(getPasswordConfirm),dispatch=(0,store.T)(),isError=(0,es.v9)(getIsPasswordConfirmValidationError),status=(0,es.v9)(getStatus),onChangePasswordConfirm=(0,react.useCallback)((function(e){dispatch(setPasswordConfirm(e.target.value))}),[dispatch]);return PasswordConfirmInput_jsx(Input.I,{label:"Подтверждение пароля",value:passwordConfirm,onChange:onChangePasswordConfirm,isError,type:"password",className,disabled:"loading"===status})};PasswordConfirmInput.displayName="PasswordConfirmInput",PasswordConfirmInput.__docgenInfo={description:"",methods:[],displayName:"PasswordConfirmInput"};try{PasswordConfirmInput.displayName="PasswordConfirmInput",PasswordConfirmInput.__docgenInfo={description:"",displayName:"PasswordConfirmInput",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/feature/ConfirmResetPassword/ui/PasswordConfirmInput/PasswordConfirmInput.tsx#PasswordConfirmInput"]={docgenInfo:PasswordConfirmInput.__docgenInfo,name:"PasswordConfirmInput",path:"src/feature/ConfirmResetPassword/ui/PasswordConfirmInput/PasswordConfirmInput.tsx#PasswordConfirmInput"})}catch(__react_docgen_typescript_loader_error){}var navigation=__webpack_require__("./node_modules/next/navigation.js"),Button=__webpack_require__("./src/shared/ui/Button/index.ts"),SubmitButton_jsx=react.createElement,SubmitButton=function SubmitButton(){var status=(0,es.v9)(getStatus),validationError=(0,es.v9)(getValidationError),dispatch=(0,store.T)(),onFormSubmit=(0,react.useCallback)((function(e){e.preventDefault(),dispatch(confirm_confirm())}),[dispatch]),router=(0,navigation.useRouter)();return(0,react.useEffect)((function(){"success"===status&&router.replace("/signin")}),[status,router]),SubmitButton_jsx(Button.z,{variant:"green",fullwidth:!0,disabled:"loading"===status||Boolean(validationError),onClick:onFormSubmit},"loading"===status?"Загрузка...":"Сохранить")};SubmitButton.displayName="SubmitButton",SubmitButton.__docgenInfo={description:"",methods:[],displayName:"SubmitButton"};try{SubmitButton.displayName="SubmitButton",SubmitButton.__docgenInfo={description:"",displayName:"SubmitButton",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/feature/ConfirmResetPassword/ui/SubmitButton/SubmitButton.tsx#SubmitButton"]={docgenInfo:SubmitButton.__docgenInfo,name:"SubmitButton",path:"src/feature/ConfirmResetPassword/ui/SubmitButton/SubmitButton.tsx#SubmitButton"})}catch(__react_docgen_typescript_loader_error){}var getRequestErrorMessage=function getRequestErrorMessage(state){var _state$confirmResetPa;return null==state||null===(_state$confirmResetPa=state.confirmResetPassword)||void 0===_state$confirmResetPa?void 0:_state$confirmResetPa.requestError},FormError_jsx=react.createElement,FormError=function FormError(props){var requestErrorMessage=(0,es.v9)(getRequestErrorMessage),validationError=(0,es.v9)(getValidationError);if(requestErrorMessage||validationError)return FormError_jsx(Form.l.Box,{margin:"auto"},validationError||requestErrorMessage)};FormError.displayName="FormError",FormError.__docgenInfo={description:"",methods:[],displayName:"FormError"};try{FormError.displayName="FormError",FormError.__docgenInfo={description:"",displayName:"FormError",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/feature/ConfirmResetPassword/ui/FormError/FormError.tsx#FormError"]={docgenInfo:FormError.__docgenInfo,name:"FormError",path:"src/feature/ConfirmResetPassword/ui/FormError/FormError.tsx#FormError"})}catch(__react_docgen_typescript_loader_error){}var injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),ConfirmResetPassword_module=__webpack_require__("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/postcss-loader/dist/cjs.js!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[4]!./src/feature/ConfirmResetPassword/ui/ConfirmResetPassword.module.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(ConfirmResetPassword_module.Z,options);const ui_ConfirmResetPassword_module=ConfirmResetPassword_module.Z&&ConfirmResetPassword_module.Z.locals?ConfirmResetPassword_module.Z.locals:void 0;var _Idle$parameters,_Idle$parameters2,ConfirmResetPassword_jsx=react.createElement,reducers={confirmResetPassword:confirmResetPasswordReducer},ConfirmResetPassword=(0,react.memo)((function(){return ConfirmResetPassword_jsx(DynamicModuleLoader.W,{reducers,removeAfterUnmount:!0},ConfirmResetPassword_jsx(Form.l,{margin:"auto",className:ui_ConfirmResetPassword_module.form},ConfirmResetPassword_jsx(PasswordInput,null),ConfirmResetPassword_jsx(PasswordConfirmInput,{className:ui_ConfirmResetPassword_module.last_input}),ConfirmResetPassword_jsx(SubmitButton,null)),ConfirmResetPassword_jsx(FormError,null))}));ConfirmResetPassword.displayName="ConfirmResetPassword";try{ConfirmResetPassword.displayName="ConfirmResetPassword",ConfirmResetPassword.__docgenInfo={description:"",displayName:"ConfirmResetPassword",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/feature/ConfirmResetPassword/ui/ConfirmResetPassword.tsx#ConfirmResetPassword"]={docgenInfo:ConfirmResetPassword.__docgenInfo,name:"ConfirmResetPassword",path:"src/feature/ConfirmResetPassword/ui/ConfirmResetPassword.tsx#ConfirmResetPassword"})}catch(__react_docgen_typescript_loader_error){}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}const ConfirmResetPassword_stories={title:"feature/ConfirmResetPassword (client)",component:ConfirmResetPassword,parameters:{mockData:[{url:backendUrl.A+"/auth/reset",method:"POST",status:201,response:"",delay:3e3}]}};var Idle={args:{},decorators:[(0,StoreDecorator.l)({confirmResetPassword:{password:"",errorMessage:void 0,passwordConfirm:"",requestError:"",status:"idle",validationErrors:{password:{empty:!1,exceedsMaxLenght:!1,exceedsMinLenght:!1,hasBannedSymbols:!1},passwordConfirm:{empty:!1,notEqualsToPassword:!1}}}})]};Idle.parameters=_objectSpread(_objectSpread({},Idle.parameters),{},{docs:_objectSpread(_objectSpread({},null===(_Idle$parameters=Idle.parameters)||void 0===_Idle$parameters?void 0:_Idle$parameters.docs),{},{source:_objectSpread({originalSource:"{\n  args,\n  decorators: [StoreDecorator({\n    confirmResetPassword: {\n      password: '',\n      errorMessage: undefined,\n      passwordConfirm: '',\n      requestError: '',\n      status: 'idle',\n      validationErrors: {\n        password: {\n          empty: false,\n          exceedsMaxLenght: false,\n          exceedsMinLenght: false,\n          hasBannedSymbols: false\n        },\n        passwordConfirm: {\n          empty: false,\n          notEqualsToPassword: false\n        }\n      }\n    }\n  })]\n}"},null===(_Idle$parameters2=Idle.parameters)||void 0===_Idle$parameters2||null===(_Idle$parameters2=_Idle$parameters2.docs)||void 0===_Idle$parameters2?void 0:_Idle$parameters2.source)})})},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/postcss-loader/dist/cjs.js!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[4]!./src/feature/ConfirmResetPassword/ui/ConfirmResetPassword.module.scss":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".ConfirmResetPassword_last_input__HTYIe{margin-bottom:16px}.ConfirmResetPassword_error__lqO3l{margin-top:8px}form.ConfirmResetPassword_form__oiaEI{margin-bottom:16px}","",{version:3,sources:["webpack://./src/feature/ConfirmResetPassword/ui/ConfirmResetPassword.module.scss"],names:[],mappings:"AAAA,wCACI,kBAAA,CAGJ,mCACI,cAAA,CAGJ,sCACI,kBAAA",sourcesContent:[".last_input{\n    margin-bottom: 16px;\n}\n\n.error{\n    margin-top: 8px;\n}\n\nform.form {\n    margin-bottom: 16px;\n}"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={last_input:"ConfirmResetPassword_last_input__HTYIe",error:"ConfirmResetPassword_error__lqO3l",form:"ConfirmResetPassword_form__oiaEI"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___}}]);